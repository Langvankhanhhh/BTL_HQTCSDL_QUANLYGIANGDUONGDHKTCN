# BTL_HQTCSDL_QUAN LY GIANG DUONG DHKTCN
- Họ Tên: LĂNG VĂN KHANH
- Msv K215480106136
- lớp K57KMT
- Ngày Làm 14-06-2024
## CHỨC NĂNG CƠ BẢN 
1 QUẢN LÝ
- 1.1	ĐẶT LỊCH PHÒNG HỌC
-  Hệ thống quản lý phòng học cho phép giáo viên và nhân viên quản lý
-  dễ dàng đặt lịchsử dụng phòng học theo lịch trình giảng dạy cá nhân.
-  Tính năng này tự động xác nhận và hủy bỏ các đặt lịch, thông báo tới người đặt và quản trị viên,
-	 tạo sự thuận lợi trong việc quản lý thời gian và phòng học.
-	 
-	1.2 QUẢN LÝ THÔNG TIN PHÒNG HỌC VÀ THIẾT BỊ
-	 Hệ thống cung cấp thông tin chi tiết về từng phòng học,
-	 bao gồm sức chứa, trang thiết bị giảng dạy, và điều kiện kỹ thuật.
-	 Giáo viên có thể dễ dàng xem xét mô tả và hình ảnh của các phòng,
-	 giúp họ chọn lựa phòng phù hợp với nội dung giảng dạy.
-	 
-	 1.3 QUẢN LÝ SỰ KIỆN VÀ HỘI THẢO
-	 Tính năng này hỗ trợ người tổ chức sự kiện đặc biệt bằng cách đặt lịch và xác nhận sự kiện,
-	 đồng thời thông báo tự động đến tất cả các bên liên quan.
-	 Việc này giúp đảm bảo sự chuẩn bị kỹ lưỡng và suôn sẻ trong việc tổ chức các hoạt động học thuật.

-	 1.4 KẾT NỐI VỚI ĐĂNG KÝ HỌC PHẦN
-	 Hệ thống tích hợp chặt chẽ với hệ thống đăng ký học phần,
-	 tự động tạo lịch học dựa trên số lượng sinh viên đăng ký và yêu cầu của khóa học.
-	 Điều này giúp giảng viên theo dõi lịch trình học, giảm tình trạng trùng lịch, và tăng tính linh hoạt.

-	 1.5 BÁO CÁO VÀ THỐNG KÊ
-	 Hệ thống cung cấp khả năng tạo báo cáo và thống kê chi tiết về việc sử dụng phòng học,
-	 tình trạng thiết bị, và các chỉ số quan trọng khác.
-	 Báo cáo này là nguồn thông tin quan trọng giúp quản trị viên đưa ra quyết định thông minh về quản lý nguồn lực và cải thiện chất lượng giảng dạy.

- 1.6 HỖ TRỢ KỸ THUẬT VÀ ĐÀO TẠO
- Hệ thống cung cấp dịch vụ hỗ trợ kỹ thuật định kỳ cho giáo viên và nhân viên quản lý,
- bao gồm cả buổi đào tạo để họ nắm vững các tính năng và cách sử dụng hệ thống.
- Điều này đảm bảo rằng người dùng có sự hỗ trợ và hiểu biết đầy đủ về hệ thống

2 CHỨC NĂNG TRUY VẤN
  - Thông tin lịch trình sử dụng không gian
  - Đặt phòng học và trang thiết bị
  - Quản lý đăng ký và xử lý yêu cầu sử dụng không gian
  - Báo cáo và thống kê
  - Hỗ trợ trực tuyến và truy vấn
  - Tuân thủ quy định và chính sách
    
3 CHỨC NĂNG NÂNG CAO
  - 3.1 Tối ưu hóa cơ sở dữ liệu
  - Quản lý giảng đường có thể sử dụng SQL để tối ưu hóa cơ sở dữ liệu của trường đại học.
  - Điều này bao gồm thiết kế cơ sở dữ liệu sao cho hiệu quả về mặt lưu trữ và truy xuất dữ liệu,
  - việc tối ưu hóa các truy vấn SQL để đảm bảo thời gian phản hồi nhanh chóng.

  - 3.2 Quản lý và xử lý dữ liệu sinh viên:
  -  Quản lý giảng đường có thể sử dụng SQL để quản lý thông tin sinh viên, bao gồm việc lưu trữ,
  -  cập nhật và truy xuất thông tin cá nhân của sinh viên, điểm số,
  -  lịch học và các hoạt động khác liên quan đến giảng dạy.

  - 3.3 Báo cáo và phân tích dữ liệu
  - Sử dụng SQL để tạo các báo cáo thống kê và phân tích dữ liệu về học phí, tỉ lệ tốt nghiệp,
  -  thống kê về sinh viên (độ tuổi, giới tính, ngành học,...),
  -  dữ liệu về đào tạo và nghiên cứu khoa học để hỗ trợ quản lý ra quyết định.
    
  - 3.4 Hỗ trợ quản lý lớp học và lịch trình
  -  Quản lý giảng đường có thể sử dụng SQL để quản lý và tổ chức lịch trình các lớp học, phân bổ phòng học,
  -  kiểm tra tính sẵn sàng của các thiết bị giảng dạy
  -  đáp ứng các yêu cầu của giảng viên và sinh viên.

  -  3.5 Quản lý đào tạo và nâng cao năng lực
  -  Sử dụng SQL để quản lý thông tin về các khoá học, chương trình đào tạo,
  -  đánh giá sinh viên và phản hồi từ học sinh để cải tiến chất lượng đào tạo.

## THIẾT KẾ CHƯƠNG TRÌNH TRONG SQL
1 TẠO BẢNG
- Bảng GiangVien:

- MaGV: Là khóa chính🔑 (primary key) của bảng GiangVien, kiểu INT, tự động tăng (IDENTITY(1,1)), 
- dùng để định danh từng giảng viên một cách duy nhất.
- HoTen: Tên của giảng viên, kiểu NVARCHAR(100).
- Khoa: Khoa mà giảng viên thuộc về, kiểu NVARCHAR(100).
  
- ![1](https://github.com/Langvankhanhhh/BTL_HQTCSDL_QUANLYGIANGDUONGDHKTCN/assets/170486633/09ce8c69-b471-4907-8943-b8b6cd592c1a)

- Bảng MonHoc:
  
 - MaMH:🔑 Là khóa chính của bảng MonHoc, kiểu INT, tự động tăng (IDENTITY(1,1)),
 - dùng để định danh từng môn học.
 - TenMH: Tên của môn học, kiểu NVARCHAR(100).
 - SoTinChi: Số tín chỉ của môn học, kiểu INT.

 - ![image](https://github.com/Langvankhanhhh/BTL_HQTCSDL_QUANLYGIANGDUONGDHKTCN/assets/170486633/8289585e-9e2d-4bc1-891b-9c4fd4d89bab)

-  Bảng LopHoc:

  - MaLop:🔑 Là khóa chính của bảng LopHoc, kiểu INT,
  - tự động tăng (IDENTITY(1,1)), dùng để định danh từng lớp học.
  - MaMH: Khóa ngoại tham chiếu đến bảng MonHoc, dùng để xác định môn học của lớp học.
  - MaGV: Khóa ngoại tham chiếu đến bảng GiangVien, dùng để xác định giảng viên phụ trách lớp học.
  - SiSo: Sĩ số của lớp học, kiểu INT.

  - ![image](https://github.com/Langvankhanhhh/BTL_HQTCSDL_QUANLYGIANGDUONGDHKTCN/assets/170486633/f0ed4b14-e3ad-425d-8ea9-89c13acd7cc6)

  - Bảng GiangDuong:

  - MaGD:🔑 Là khóa chính của bảng GiangDuong, kiểu INT, tự động tăng (IDENTITY(1,1)),
  - dùng để định danh từng giảng đường.
  - TenGD: Tên của giảng đường, kiểu NVARCHAR(100).
  - SucChua: Sức chứa của giảng đường, kiểu INT.

  - ![image](https://github.com/Langvankhanhhh/BTL_HQTCSDL_QUANLYGIANGDUONGDHKTCN/assets/170486633/e5ebd1c0-4b74-41a9-afd8-dcc6cf298ee7)

  - Bảng ThoiKhoaBieu:

  - MaTKB:🔑 Là khóa chính của bảng ThoiKhoaBieu,
  - kiểu INT, tự động tăng (IDENTITY(1,1)),
  - dùng để định danh từng thời khóa biểu.
  - MaLop: Khóa ngoại tham chiếu đến bảng LopHoc,
  - dùng để xác định lớp học trong thời khóa biểu.
  - MaGD: Khóa ngoại tham chiếu đến bảng GiangDuong,
  - dùng để xác định giảng đường sử dụng trong thời khóa biểu.
  - ThoiGian: Thời gian diễn ra lớp học, kiểu DATETIME.

  - ![image](https://github.com/Langvankhanhhh/BTL_HQTCSDL_QUANLYGIANGDUONGDHKTCN/assets/170486633/79439619-aac2-4a68-8c2b-3bbc2d5eab70)

  - SƠ ĐỒ THỰC THỂ LIÊN KẾT
  - ![Screenshot (171)](https://github.com/Langvankhanhhh/BTL_HQTCSDL_QUANLYGIANGDUONGDHKTCN/assets/170486633/0639e6db-1b90-4b1a-bf69-065d409aa489)

2 THÊM DỮ LIỆU VÀO BẢNG
- ADD VÀO CÁC 
- chèn dữ liệu vào bảng giangvien
- GiangVien INSERT INTO GiangVien
- (HoTen, Khoa) VALUES('Nguyen Van A', 'CNTT'),('Le Thi B', 'Toan');
- chèn liệu vào bảng monhoc
- MonHocINSERT INTO MonHoc
- (TenMH, SoTinChi) VALUES('Lap Trinh C', 3),('Toan Roi Rac', 4);
- chèn liệu vào bảng giangduong
- GiangDuongINSERT INTO GiangDuong (TenGD, SucChua) VALUES('GD101', 50),('GD102', 100);
- chèn liệu vào bảng lophoc
- LopHocINSERT INTO LopHoc (MaMH, MaGV, SiSo) VALUES(1, 1, 45),(2, 2, 60);
- chèn dữ liệu vào bảng thoikhoabieu
- ThoiKhoaBieuINSERT INTO ThoiKhoaBieu (MaLop, MaGD, ThoiGian) VALUES(1, 1, '2024-06-20 08:00:00'),(2, 2, '2024-06-21 10:00:00');


## THIẾT LẬP CHỨC NĂNG
1 CHỨC NĂNG CƠ BẢN
1.1 CHỨC NĂNG TÌM KIẾM THÔNG 

* yêu cầu thêm xóa
  - CREATE PROCEDURE XoaGiangVien;
* sửa giảng viên
  - CREATE PROCEDURE SuaGiangVien;
1.2 CHỨC NĂNG THÊM XÓA, SỬA
- CHỨC NĂNG XÓA
    - ![image](https://github.com/Langvankhanhhh/BTL_HQTCSDL_QUANLYGIANGDUONGDHKTCN/assets/170486633/bca7eb9e-afc8-4b83-9332-40f507a313f7)
- CHỨC NĂNG SỬA
    - ![image](https://github.com/Langvankhanhhh/BTL_HQTCSDL_QUANLYGIANGDUONGDHKTCN/assets/170486633/34355c01-31b3-48c0-8035-1ae1da1b3311)
      
1.3 VIEW HIỂN THỊ THÔNG TIN
     - ![image](https://github.com/Langvankhanhhh/BTL_HQTCSDL_QUANLYGIANGDUONGDHKTCN/assets/170486633/858359ec-6728-4253-8a02-287375cb2e1e)

2 CHỨC NĂNG NÂNG CAO
    - CREATE TRIGGER CheckSucChuaTruocKhiInsert
- ON ThoiKhoaBieu
- INSTEAD OF INSERT
- AS
- BEGIN
  -  DECLARE @siSo INT;
  -  DECLARE @sucChua INT;
  -  DECLARE @MaLop INT;
  -  DECLARE @MaGD INT;

-- Xử lý khi thêm hoặc cập nhật vật dụng bị đánh cắp
IF EXISTS (SELECT * FROM inserted)
BEGIN
    DECLARE @GiangDuongID INT;
    DECLARE @VatDungID INT;
    
    SELECT @GiangDuongID = GiangDuongID, @VatDungID = VatDungID FROM inserted;
    
    -- Kiểm tra và cập nhật thông tin vật dụng bị đánh cắp
    UPDATE VatDungGiangDuong
    SET DaDanCap = 1 -- Đánh dấu là đã bị đánh cắp
    WHERE GiangDuongID = @GiangDuongID AND VatDungID = @VatDungID;
    
    -- Cập nhật số lượng vật dụng đã đánh cắp trong giảng đường
    UPDATE GiangDuong
    SET SoLuongVatDungDaDanCap = SoLuongVatDungDaDanCap + 1
    WHERE ID = @GiangDuongID;
END;

-- Xử lý khi hủy bỏ đánh cắp vật dụng
IF EXISTS (SELECT * FROM deleted)
BEGIN
    DECLARE @GiangDuongIDDel INT;
    DECLARE @VatDungIDDel INT;
    
    SELECT @GiangDuongIDDel = GiangDuongID, @VatDungIDDel = VatDungID FROM deleted;
    
    -- Kiểm tra và cập nhật thông tin vật dụng bị hủy bỏ đánh cắp
    UPDATE VatDungGiangDuong
    SET DaDanCap = 0 -- Đánh dấu là không còn bị đánh cắp
    WHERE GiangDuongID = @GiangDuongIDDel AND VatDungID = @VatDungIDDel;
    
    -- Cập nhật số lượng vật dụng đã đánh cắp trong giảng đường
    UPDATE GiangDuong
    SET SoLuongVatDungDaDanCap = CASE WHEN SoLuongVatDungDaDanCap > 0 THEN SoLuongVatDungDaDanCap - 1 ELSE 0 END
    WHERE ID = @GiangDuongIDDel;
END;

- TÌM KIẾM THÔNG TIN
- SELECT
  - gd.MaGD AS IDGiangDuong,
  - gd.TenGD AS TenGiangDuong,
  -  gd.SucChua,
  -  dd.ID AS IDDiaDiem,
 -   dd.TenDiaDiem,
  -  ISNULL(AVG(dg.SoSao), 0) AS TrungBinhSoSao
-FROM
 -    GiangDuong gd
-LEFT JOIN
 -   DiaDiemDuLich dd ON gd.DiaDiemID = dd.ID
-LEFT JOIN
-    DanhGia dg ON gd.MaGD = dg.GiangDuongID
-GROUP BY
-    gd.MaGD, gd.TenGD, gd.SucChua, dd.ID, dd.TenDiaDiem;

- FROM GiangDuong gd:
- Bảng GiangDuong được đặt alias là gd, chứa thông tin về các giảng đường.
- LEFT JOIN DiaDiemDuLich
-  dd ON gd.DiaDiemID = dd.ID: Sử dụng LEFT JOIN để kết nối bảng DiaDiemDuLich (alias là dd) với GiangDuong dựa trên trường DiaDiemID, để lấy thông tin về địa điểm du lịch mà giảng đường liên kết đến.
- LEFT JOIN DanhGia
-  dg ON gd.MaGD = dg.GiangDuongID: Sử dụng LEFT JOIN để kết nối bảng DanhGia (alias là dg) với GiangDuong dựa trên trường GiangDuongID, để lấy thông tin về các đánh giá của giảng đường.
-SELECT:

- gd.MaGD AS IDGiangDuong: Chọn MaGD (ID của giảng đường) và đổi tên cột thành IDGiangDuong.
- gd.TenGD AS TenGiangDuong: Chọn TenGD (tên của giảng đường).
- gd.SucChua: Chọn Sức chứa của giảng đường.
- dd.ID AS IDDiaDiem: Chọn ID của địa điểm du lịch từ bảng DiaDiemDuLich.
- dd.TenDiaDiem: Chọn Tên của địa điểm du lịch từ bảng DiaDiemDuLich.
- ISNULL(AVG(dg.SoSao), 0) AS TrungBinhSoSao: Tính trung bình số sao từ các đánh giá của giảng đường (AVG(dg.SoSao)), và sử dụng ISNULL để trả về 0 nếu không có đánh giá nào.
- GROUP BY gd.MaGD, gd.TenGD, gd.SucChua, dd.ID, dd.TenDiaDiem: Nhóm kết quả theo các cột được chọn từ bảng GiangDuong và DiaDiemDuLich.

  * KẾT QUẢ
    - View hiển thị GiangVien_LopHoc AS
SELECT GV.HoTen, MH.TenMH, LH.SiSo
FROM GiangVien GV
JOIN LopHoc LH ON GV.MaGV = LH.MaGV
JOIN MonHoc MH ON LH.MaMH = MH.MaMH;

    - ![Capture](https://github.com/Langvankhanhhh/BTL_HQTCSDL_QUANLYGIANGDUONGDHKTCN/assets/170486633/affbc6e6-ffff-40be-94b5-afc53b530d23)
  
- View hiển thị thời khóa biểu chi tiết
- CREATE VIEW V_ThoiKhoaBieu AS
- SELECT TKB.MaTKB, GV.HoTen, MH.TenMH, GD.TenGD, TKB.ThoiGian
- FROM ThoiKhoaBieu TKB
- JOIN LopHoc LH ON TKB.MaLop = LH.MaLop
- JOIN GiangVien GV ON LH.MaGV = GV.MaGV
- JOIN MonHoc MH ON LH.MaMH = MH.MaMH
- JOIN GiangDuong GD ON TKB.MaGD = GD.MaGD;
- ![Capture 1](https://github.com/Langvankhanhhh/BTL_HQTCSDL_QUANLYGIANGDUONGDHKTCN/assets/170486633/4fe2de9d-99da-45b8-b740-8721215042df)

